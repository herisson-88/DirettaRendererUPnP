# Diretta UPnP Renderer Configuration
# 
# This file is sourced by the systemd service unit.
# Modify these values to change renderer behavior.
#
# After changing values, reload:
#   sudo systemctl daemon-reload
#   sudo systemctl restart diretta-renderer

# ============================================================================
# BASIC SETTINGS
# ============================================================================

# Target Diretta device number (1 = first found)
TARGET=1

# UPnP port (default: 4005)
PORT=4005

# Buffer size in seconds (1.0 - 5.0)
# Recommended: 2.0 for most, 3.0-4.0 for DSD512+
BUFFER=2.0


# Verbose logging
# Add "--verbose" to enable debug logs, leave empty for normal output
VERBOSE=""

# ============================================================================
# NETWORK INTERFACE SETTINGS (for multi-homed systems)
# ============================================================================
# 
# For systems with multiple network interfaces (e.g., 3-tier architecture),
# specify which interface to use for UPnP discovery and SSDP broadcasts.
#
# This is essential for proper operation when you have:
#   - Multiple network cards (eth0, eth1, eno1, eno2, etc.)
#   - VPN connections
#   - Bridged networks
#   - Separate control and audio networks
#
# IMPORTANT: Choose the interface connected to your UPnP control points
#            (e.g., JPlay, Roon, BubbleUPnP), NOT the Diretta audio network!
#
# Examples:
#   NETWORK_INTERFACE="eth0"           # Use interface name (recommended)
#   NETWORK_INTERFACE="192.168.1.10"  # Use specific IP address
#   NETWORK_INTERFACE=""               # Auto-detect (default)
#
# Common scenarios:
#
#   Single network (default):
#     NETWORK_INTERFACE=""
#
#   3-tier architecture (recommended by dsnyder):
#     Control Points: 192.168.1.x on eth0
#     Host:          192.168.1.10 (eth0) + 192.168.2.10 (eth1)
#     Diretta DAC:   192.168.2.100 on eth1
#     
#     Use: NETWORK_INTERFACE="eth0"
#          TARGET should point to 192.168.2.100
#
#   VPN + Local network:
#     Local:  192.168.1.x on eth0
#     VPN:    10.0.0.x on tun0
#     
#     Use: NETWORK_INTERFACE="eth0" (for local control points)
#
# To list your network interfaces:
#   ip link show
#   ip addr show
#
NETWORK_INTERFACE=""

# ============================================================================
# TRANSFER MODE SETTINGS (v1.3.0+)
# ============================================================================
# 
# Transfer mode controls how audio packets are sent to the Diretta DAC.
# Two modes available: varmax (adaptive) and fix (precise timing)
#
# VARMAX MODE (default - recommended for most users):
#   - Adaptive cycle timing (varies between min and max)
#   - Optimal bandwidth usage
#   - Best for general use
#   - Leave TRANSFER_MODE commented or set to "varmax"
#
# FIX MODE (for audiophile experimentation):
#   - Fixed cycle timing (constant, precise)
#   - Requires explicit CYCLE_TIME value
#   - Some users report perceiving sonic differences
#   - Particularly 528 Hz (1893 µs) is reported as "musical"
#
# IMPORTANT: If you use fix mode, you MUST set CYCLE_TIME!
#
# Examples:
#
#   Default adaptive mode:
#     #TRANSFER_MODE=""           # or leave commented
#
#   Fixed timing at 528 Hz (1893 µs):
#     TRANSFER_MODE="fix"
#     CYCLE_TIME=1893
#
#   Fixed timing at 500 Hz (2000 µs):
#     TRANSFER_MODE="fix"
#     CYCLE_TIME=2000
#
#   Fixed timing at 1 kHz (1000 µs):
#     TRANSFER_MODE="fix"
#     CYCLE_TIME=1000
#
# Popular fixed cycle values:
#   1893 µs = 528 Hz  (reported as "musical" by some audiophiles)
#   2000 µs = 500 Hz  (nice round number)
#   1000 µs = 1000 Hz (1 kHz timing)
#
# Note: Scientific evidence for audible differences is limited.
#       Your experience may vary. A/B testing recommended.
#
#TRANSFER_MODE=""

# ============================================================================
# ADVANCED DIRETTA SDK SETTINGS
# ============================================================================
# Leave commented to use defaults. Uncomment and modify to override.

# Thread Mode (bitmask - add values together)
# Default: 1 (Critical only)
# 
# Available flags:
#   1     = Critical (REALTIME priority)
#   2     = NoShortSleep
#   4     = NoSleep4Core
#   8     = SocketNoBlock
#   16    = OccupiedCPU
#   32    = FEEDBACK (moving average)
#   64    = FEEDBACK (moving average)
#   128   = FEEDBACK (moving average)
#   256   = NOFASTFEEDBACK
#   512   = IDLEONE
#   1024  = IDLEALL
#   2048  = NOSLEEPFORCE
#   4096  = LIMITRESEND
#   8192  = NOJUMBOFRAME
#   16384 = NOFIREWALL
#   32768 = NORAWSOCKET
#
# Examples:
#   1     = Default (Critical only)
#   17    = Critical + OccupiedCPU (1+16)
#   33    = Critical + FEEDBACK32 (1+32)
#
#THREAD_MODE=1

# Transfer Packet Cycle Time (microseconds)
# Default: 10000 (10ms)
# Range: 333-10000
# 
# Usage depends on TRANSFER_MODE:
#   VarMax mode: This is the MAXIMUM cycle time (optional)
#   Fix mode:    This is the FIXED cycle time (REQUIRED)
#
# Examples for Fix mode:
#   CYCLE_TIME=1893  # 528 Hz (audiophile favorite)
#   CYCLE_TIME=2000  # 500 Hz
#   CYCLE_TIME=1000  # 1000 Hz
#
#CYCLE_TIME=10000

# Transfer Packet Cycle Minimum Time (microseconds)
# Only used in VarMax mode (adaptive range)
# Default: 333
#CYCLE_MIN_TIME=333

# Information Packet Cycle Time (microseconds)
# Default: 100000 (100ms)
#INFO_CYCLE=100000

# MTU Override (bytes)
# Default: auto-detect
# Common values: 1500 (standard), 9000 (jumbo), 16128 (max jumbo)
#MTU_OVERRIDE=""

# ============================================================================
# TROUBLESHOOTING
# ============================================================================
#
# Problem: Renderer not discovered by control points in 3-tier setup
# Solution: Set NETWORK_INTERFACE to the interface with control points
#           Example: NETWORK_INTERFACE="eth0"
#
# Problem: How to find which interface to use?
# Solution: Run: ip addr show
#           Look for the IP on the same subnet as your control points
#
# Problem: Renderer discovered but no audio
# Solution: Check TARGET points to correct Diretta DAC IP on audio network
#
# Problem: Want to test Fix mode at 528 Hz?
# Solution: Uncomment TRANSFER_MODE and CYCLE_TIME:
#           TRANSFER_MODE="fix"
#           CYCLE_TIME=1893
#           Then: sudo systemctl restart diretta-renderer
#
# For more help: https://github.com/cometdom/DirettaRendererUPnP/issues
